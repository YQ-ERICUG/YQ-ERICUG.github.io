<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>BP Manual 07-Back-projecting in high frequency band - Qiang</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Qiang" /><meta name="description" content="The part is main body of Back-projection.
 After preprocessing in a low frequency band, waveforms have been aligned preliminarily. Next we start to cross correlate with a higher frequency band and stack waveforms for all grid points.
set cl = 2 # upper bound of low frequency band set ch = 0.5 # lower bound of low frequency band  $ csh back-projection_2.csh
# open back-projection_2.csh to look over all commands" /><meta name="keywords" content="earthquake, seismology, real-time" />






<meta name="generator" content="Hugo 0.74.3 with theme even" />


<link rel="canonical" href="http://yq-ericug.github.io/post/BP_high/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.8c3cbcb0324c2bb4875ceccba4007cbad4b4ac8377f33af9953c3e7684534a50.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="BP Manual 07-Back-projecting in high frequency band" />
<meta property="og:description" content="The part is main body of Back-projection.
 After preprocessing in a low frequency band, waveforms have been aligned preliminarily. Next we start to cross correlate with a higher frequency band and stack waveforms for all grid points.
set cl = 2 # upper bound of low frequency band set ch = 0.5 # lower bound of low frequency band  $ csh back-projection_2.csh
# open back-projection_2.csh to look over all commands" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://yq-ericug.github.io/post/BP_high/" />
<meta property="article:published_time" content="2018-07-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-10-24T00:00:00+00:00" />
<meta itemprop="name" content="BP Manual 07-Back-projecting in high frequency band">
<meta itemprop="description" content="The part is main body of Back-projection.
 After preprocessing in a low frequency band, waveforms have been aligned preliminarily. Next we start to cross correlate with a higher frequency band and stack waveforms for all grid points.
set cl = 2 # upper bound of low frequency band set ch = 0.5 # lower bound of low frequency band  $ csh back-projection_2.csh
# open back-projection_2.csh to look over all commands">
<meta itemprop="datePublished" content="2018-07-06T00:00:00+00:00" />
<meta itemprop="dateModified" content="2018-10-24T00:00:00+00:00" />
<meta itemprop="wordCount" content="388">



<meta itemprop="keywords" content="Back-projection,Data processing," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BP Manual 07-Back-projecting in high frequency band"/>
<meta name="twitter:description" content="The part is main body of Back-projection.
 After preprocessing in a low frequency band, waveforms have been aligned preliminarily. Next we start to cross correlate with a higher frequency band and stack waveforms for all grid points.
set cl = 2 # upper bound of low frequency band set ch = 0.5 # lower bound of low frequency band  $ csh back-projection_2.csh
# open back-projection_2.csh to look over all commands"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Qiang</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Qiang</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">BP Manual 07-Back-projecting in high frequency band</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-07-06 </span>
        <div class="post-category">
            <a href="/categories/Back-projection-manual/"> Back-projection manual </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#duplicate">Duplicate</a></li>
  </ul>

  <ul>
    <li><a href="#cross-correlate-1st">Cross correlate 1st</a></li>
    <li><a href="#form-model-seismogram">Form model seismogram</a></li>
    <li><a href="#cross-correlate-2nd">Cross correlate 2nd</a></li>
    <li><a href="#stack-seismogram">Stack seismogram</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <blockquote>
<p>The part is main body of Back-projection.</p>
</blockquote>
<p>After preprocessing in a low frequency band, waveforms have been aligned preliminarily. Next we start to cross correlate with a higher frequency band and stack waveforms for all grid points.</p>
<pre><code>set cl            = 2        # upper bound of low frequency band
set ch            = 0.5      # lower bound of low frequency band
</code></pre>
<p><code>$ csh back-projection_2.csh</code></p>
<p><code># open back-projection_2.csh to look over all commands </code></p>
<h2 id="duplicate">Duplicate</h2>
<p>Duplicate results from preprocessing in low frequency band. We repeat some steps in last chapter, and read station correction information by lower frequency saved in file <em>cc30_raw.out</em>.</p>
<h1 id="heading"></h1>
<pre><code># open stack_Tshift_raw-EU.f to look over full commands

open (11, file='cc30_raw.out')
  n_temp=0
  do
     read(11,'(i8,a3,a4)',iostat=iostat) cc_time_shift(n_temp+1),
   &amp;net,stanm_cc(n_temp+1);if (iostat.ne.0) exit
     write(*,*)cc_time_shift(n_temp+1),
   &amp;stanm_cc(n_temp+1)
 n_temp=n_temp+1     
  end do  
close(11)
</code></pre>
<h2 id="cross-correlate-1st">Cross correlate 1st</h2>
<p>Cross correlate with model station&rsquo;s waveform with high frequency band. Usually, we cross correlate using a long window and remove data with low cross-correlation, then cross correlate using a shorter window.</p>
<pre><code>Here are parameters:

# open back-projection_2.csh to look over all commands

set window_length_L = 40       # length of long window for cross correlation
set lag_lenth_L     = 5        # lenth of time shift
set cc_min_L        = 0.02     # minimum of cross-correlation to eliminate bad data

set window_length = 10       # length of window for cross correlation
set lag_lenth     = 10       # lenth of time shift
set cc_min        = 0.4      # minimum of cross-correlation to eliminate bad dat
</code></pre>
<h2 id="form-model-seismogram">Form model seismogram</h2>
<p>Sum waveforms to form the model seismogram. Heretofore, model seismogram we talked about is from model staion. But from now, we get model waveform by average all good-quality waveforms.</p>
<center>![](https://raw.githubusercontent.com/YQ-ERICUG/Back-projection/master/05.png)</center>
<p><em>Seismogram from model station (above), and synthetic model seismgram (below).</em></p>
<p><code># Open stack_Tshift_raw-EU.f to view details </code></p>
<h2 id="cross-correlate-2nd">Cross correlate 2nd</h2>
<p>Cross correlate with model seismogram following before steps three times.</p>
<p><code># Open stack_Tshift_raw-EU.f to view details </code></p>
<h2 id="stack-seismogram">Stack seismogram</h2>
<p>We have eliminated heterogeneous effect beneath stations by shifting waveforms depend on the first grid (epicenter). For other grid points, we need to cancel out influnce of various epicentral distances, and stack seismograms for a time window.</p>
<h1 id="heading-1"></h1>
<pre><code>Here are some parameters for stacking:

# open back-projection_2.csh to look over all commands

set wlen          = 10       # length of window for stacking windows
set wdif          = 2.0      # interval of stacking windows
set nwin          = 100      # number of stacking windows 
</code></pre>
<p><img src="https://raw.githubusercontent.com/YQ-ERICUG/Back-projection/master/06.png" alt=""></p>
<p><code># Open stack_Tshift_raw-EU.f to view details </code></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Qiang</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2018-10-24
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/Back-projection/">Back-projection</a>
          <a href="/tags/Data-processing/">Data processing</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/Sum_energy/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">BP Manual 08-Summarizing and plotting figure</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/Propress/">
            <span class="next-text nav-default">BP Manual 06-Preprocessing in low frequency band</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:jonyau@cug.edu.cn" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/YQ-ERICUG" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/yao-qiang-62-84" class="iconfont icon-zhihu" title="zhihu"></a>
  <a href="http://yq-ericug.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2018 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Qiang</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js"></script>








</body>
</html>
